<div class="minicart">
    <div class="minicart-title">
      <div>Your Cart - item</div>
      <button class="cart-cancel">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    {% if cart.item_count > 0 %}
      <form
        action="/cart"
        method="post"
        class="minicart-product-list">
        {% for item in cart.items %}
          <div class="minicart-product">
            <div class="minicart-product-image">
              <a href="{{ item.url | within: :collections.all }}">
                <img src="{{ item | img_url: 'medium' }}" alt="{{ item.title | escape }}">
              </a>
            </div>
            <div class="minicart-product-description">
              <div class="flex-direction-column">
                <div class="minicart-product-title">
                  <a href="{{ item.url }}">
                    {{ item.product.title }}
                    <br>
                    ( {{ item.variant.title }} )
                  </a>
                </div>
                <div class="qtydiv">
                  <div class="qtybox">
                    <button class="btnqty qtyminus icon icon-minus">-</button>
                    <input type="number" id="updates_{{ item.key }}" name="updates[]" value="{{ item.quantity }}" min="1" class="quantity-selector quantity-input">
                    <button class="btnqty qtyplus icon icon-plus">+</button>
                  </div>
                  <div class="rmvbtn">
                    <a href="/cart/change?line={{ forloop.index }}&amp;quantity=0">X</a>
                  </div>
                </div>
              </div>
              <div class="minicart-product-price">
                {{ item.price | money | replace: " ", "" }}
              </div>
            </div>
          </div>
        {% endfor %}
        <div></div>
      </form>

      <div class="minicart-note">
        <div>Add a note to your order</div>
        <textarea
          name="noteOrder"
          rows="3"
          cols="25"></textarea>
      </div>

      <div class="minicart-detail">
        <div class="minicart-detail-total">
          <strong>Subtotal</strong>
          <span class="cart__total-price">{{ cart.total_price | money }}</span>
        </div>
        <button
          class="button"
          type="submit"
          name="checkout">Checkout</button>
      </div>
    {% else %}
      <div style="text-align:center; margin:auto; padding-top: 30px;">Cart is empty</div>
    {% endif %}
    {%- comment -%} <input type="submit" name="checkout" value="Checkout"> {%- endcomment -%}
    </div>

<script>
  document.querySelectorAll('.qtybox .btnqty').forEach(button => {
    button.addEventListener('click', () => {
      const input = button.parentElement.querySelector('input');
      const value = Number(input.value);
      const isPlus = button.classList.contains('.qtyplus');
      const isMinus = button.classList.contains('.qtyminus');

      if (isPlus) {
        input.value = value + 1;
      } else if (value > 1) {
        input.value = value - 1;
      }
    })
  })
</script>